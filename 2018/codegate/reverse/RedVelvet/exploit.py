#!/usr/bin/env python

from z3 import IntVector, Solver, unsat, Or, String, Xor, BitVec

s = Solver()

a = BitVec('a', 32)
b = BitVec('b', 32)
c = BitVec('c', 32)
d = BitVec('d', 32)
e = BitVec('e', 32)
f = BitVec('f', 32)
g = BitVec('g', 32)
h = BitVec('h', 32)
i = BitVec('i', 32)
j = BitVec('j', 32)
k = BitVec('k', 32)
l = BitVec('l', 32)
n = BitVec('n', 32)
o = BitVec('o', 32)
p = BitVec('p', 32)
q = BitVec('q', 32)
r = BitVec('r', 32)
t = BitVec('t', 32)
u = BitVec('u', 32)
v = BitVec('v', 32)
w = BitVec('w', 32)
x = BitVec('x', 32)
y = BitVec('y', 32)
z = BitVec('z', 32)
aa = BitVec('aa', 32)
bb = BitVec('bb', 32)

#Func 1
s.add(a*2 * (a^b) - b == 10858)
s.add(a > 85)
s.add(a <= 95)
s.add(b > 96)
s.add(b <= 111)

#Func 2
s.add(b%c == 7)
s.add(c > 90)

#func3
s.add(c/d + (c^d) == 21)
s.add(c <= 99)
s.add(d <= 119)

#func4
s.add(((e^d^e)%e)+d == 137)
s.add(d > 115)
s.add(e <= 99)
s.add(e == 95)

#func5
s.add(((f+e)^(e^f^e)) == 225)
s.add(e > 90)
s.add(f <= 89)
s.add(f >= 10)

#func6
s.add(f <= g)
s.add(g <= h)
s.add(f > 85)
s.add(g > 110)
s.add(h > 115)
s.add((g+h)^(f+g) == 44)
s.add((g+h)%f + g == 161)

#func7
s.add(h >= i)
s.add(i >= j)
s.add(h <= 119)
s.add(i > 90)
s.add(j <= 89)
s.add((h+j)^(i+j) == 122)
s.add((h+j)%i + j == 101)

#func8
s.add(j <= k)
s.add(k <= l)
s.add(l <= 114)
s.add((j+k)/l*k == 97)
s.add((l^(j-k))*k == -10088)

#func9
s.add(l == n)
s.add(n >= o)
s.add(o <= 99)
s.add(o+l*(o-n)-l == -1443)

#func10
s.add(o >= p)
s.add(p >= q)
s.add(p*(o+q+1)-q == 15514)
s.add(p > 90)
s.add(q <= 99)
s.add(q >= 10)
s.add(p <= 255)

#func11
s.add(r >= q)
s.add(q >= t)
s.add(r > 100)
s.add(r <= 104)
s.add(q+(r^(r-t))-t == 70)
s.add((r+t)/q + q == 68)

#func12
s.add(t >= u)
s.add(u >= v)
s.add(u <= 59)
s.add(v <= 44)
s.add(t+(u^(u+v))-v == 111)
s.add((u^(u-v))+u == 101)

s.add(u > 10)
s.add(v > 10)

#func13
s.add(v <= w)
s.add(w <= x)
s.add(v > 40)
s.add(w > 90)
s.add(x <= 109)
s.add(x+(w^(x+v))-v == 269)
s.add((x^(w-v))+w == 185)

#func14
s.add(x >= z)
s.add(y >= z)
s.add(y <= 99)
s.add(z > 90)
s.add(x+(y^(y+x))-z == 185)

#func15
s.add(aa >= bb)
s.add(aa >= z)
s.add(bb > 95)
s.add(aa <= 109)
s.add(((aa-z)*aa^bb)-z == 1214)
s.add(((bb-aa)*bb^z)+aa == -1034)

s.add(bb < 255)
s.add(bb > 10)
s.add(aa > 0)
s.add(aa < 255)

# Let z3 do the work
while s.check() != unsat:
    m = s.model()

    print "[+] " + chr(m[a].as_long()) + chr(m[b].as_long()) + chr(m[c].as_long()) + chr(m[d].as_long()) + chr(m[e].as_long()) + chr(m[f].as_long()) + chr(m[g].as_long()) + chr(m[h].as_long()) + chr(m[i].as_long()) + chr(m[j].as_long()) + chr(m[k].as_long()) + chr(m[l].as_long()) + chr(m[n].as_long()) + chr(m[o].as_long()) + chr(m[p].as_long()) + chr(m[q].as_long()) + chr(m[r].as_long()) + chr(m[t].as_long()) + chr(m[u].as_long()) + chr(m[v].as_long()) + chr(m[w].as_long()) + chr(m[x].as_long()) + chr(m[y].as_long()) + chr(m[z].as_long()) + chr(m[aa].as_long()) + chr(m[bb].as_long())

    s.add(Or(m[y] != y))

print "No more solution found."

